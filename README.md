# FuelStat
A program that expands fuel statistics

Задача из книги Чарльза Уэзерелла "Этюды для программистов".

# Задача: Горючие слезы, или Учет расхода бензина.
Задача состоит в том, чтобы расширить таблицу(журнал покупок бензина).

## Исходная таблица состоит из:
1. Дата
2. Марка бензина
3. Пробег
4. Цена галлона
5. Количество галлонов
6. Общая стоимость

## Расширенная таблица состоит из:
1. Дата
2. Марка бензина
3. Пробег
4. Цена галлона
5. Количество галлонов
6. Общая стоимость
7. Пробег между заправками
8. Пробег на одном голлоне
9. Стоимость одной мили
11. Стоимость одного дня
12. Время расходавания одного галлона
13. Данные по каждой заправке(среднее значение цены, 
    расстояния и количество заправок)


## Основные условия:
1. Известно, что каждовой новой записи в журнале соответсвует
    новая полная заправка. Исходя из этого можно сказать,
    что количество галлонов, которые он покупает на новой заправке
    показывают, сколько галлонов он потратил после прошлой заправки
     Следовательно в строке с новой заправкой
    указывается расстояние пройденное до новой заправки и 
    количество галлонов, которые были потрачены после
    предыдущей заправки. А цена голона и цена купленных голонов с
    новой заправки. 


## Как это работает:
1. Создаем исходную таблицу в Excel.
2. Получаем исходную таблицу и начинаем работать с ней.
3. Находим расстояние, которое мы проехали между двумя разными
    заправками.
    1. Если это первая заправка, то сохраняем ее название,
        номер строки и переходим к следующей строке.
    2. Если названия заправок одинаковые, то переходим
        к следующей строке(заправке).
    3. Если названия заправок разные.
        1. Сохраняем название и номер строки.
        2. Отнимаем расстояние старой заправки от
            расстояния заправки с новым названием.
        3. Вместо названия и номера сроки старой заправки,
            устанавливаем название и номер строки текущей заправки
        4. Если это последняя заправка то переходим
            к пп. 4.
        5. Иначе переходим к пп. 3.2.
4. Находим пройденное расстояние на одном галлоне.
    1. Если это первая заправка, то переходим к следующей.
    2. Находим расстояние, которое автомобиль прошел после предыдущей
        заправки
        1. Отнимаем расстояние до предыдущей заправки от
            расстояния до текущей заправки.
        2. Полученной расстояние делим на количесво галлонов купленных
            на текущей заправке.
        3. Если это последняя заправка переходим к пп. 5. 
        4. Иначе переходим к следующей строке и к пп. 4.2.
5. Находим стоимость одной мили.
    1. Если это первая заправка, то переходим к следующей.
    2. Находим количество галлонов потраченных за одну милю
        1. Отнимаем расстояние до предыдущей заправки от
            расстояния до текущей заправки.
        2. Количество галлонов, которые мы заправили на текущей
            заправки делим на полученное расстояние.
        3. Полученное значение умножаем на цену галлона предыдущей
            заправки.
        3. Если это последняя заправка переходим к пп. 6. 
        4. Иначе переходим к следующей строке и к пп. 5.2.
6. Находим стоимость одного дня.
    1. Создадим цену дня равную нулю.
    2. Если это первая заправка
        1. Сохраняем дату.
        2. Прибавляем к цене дня сумму.
        3. Переходим к следующей строке.
    3. Проверяем дату заправки.
        1. Если даты совпадают.
            1. Прибавляем к цене дня сумму.
            2. Если это последняя заправка.
                1. Выводим цену дня в таблицу
            3. Иначе.
                1. Переходим к следующей заправке
        2. Если даты не совпадают.
            1. Выводим сумму дня в таблицу.
            2. Если это не последняя заправка.
                1. Сохраняем дату.
                2. Обнуляем цену дня.
                3. Прибавляем к цене дня сумму.
                4. Переходим к следующему заправке.
                2. Переходим к пп 6.3.